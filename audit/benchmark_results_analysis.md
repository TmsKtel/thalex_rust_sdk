# –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –±–µ–Ω—á–º–∞—Ä–∫–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## –û–±–∑–æ—Ä

–ë–µ–Ω—á–º–∞—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –ù–∏–∂–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –≤—ã–≤–æ–¥—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –Ø–Ω–≤–∞—Ä—å 2025 (–ø–æ—Å–ª–µ –º–µ—Ä–∂–∞ main –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è rustc)

**–°–º. —Ç–∞–∫–∂–µ:** [thalex_rust_sdk_performance_reaudit_2025.md](./thalex_rust_sdk_performance_reaudit_2025.md) - –ø–æ–ª–Ω—ã–π –æ—Ç—á–µ—Ç –æ –ø–µ—Ä–µ–∞–Ω–∞–ª–∏–∑–µ

## –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏

### 1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (`handle_incoming`)

| –°—Ü–µ–Ω–∞—Ä–∏–π | –í—Ä–µ–º—è (2025) | –í—Ä–µ–º—è (2024) | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|----------|--------------|--------------|-----------|
| RPC –æ—Ç–≤–µ—Ç (–ø—É—Å—Ç—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã) | 335.01 ns | ~317 ns | ‚ö†Ô∏è +5.7% |
| RPC –æ—Ç–≤–µ—Ç (—Å pending –∑–∞–ø—Ä–æ—Å–æ–º) | 324.75 ns | ~306 ns | ‚ö†Ô∏è +6.1% |
| Ticker –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ | 466.09 ns | ~459 ns | ‚ö†Ô∏è +1.5% |
| Ticker —Å –ø–æ–¥–ø–∏—Å–∫–æ–π | 959.41 ns | ~792 ns | ‚ö†Ô∏è **+21.1%** |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å–æ–∫ (1-100) | 490.98-502.25 ns | ~464-481 ns | ‚ö†Ô∏è +5-4% |
| –ú–Ω–æ–∂–µ—Å—Ç–≤–æ pending (1-100) | 324.98-333.38 ns | ~307-314 ns | ‚ö†Ô∏è +5-6% |

**–í—ã–≤–æ–¥—ã:**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ RPC –æ—Ç–≤–µ—Ç–æ–≤ –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ (~300 ns)
- ‚ö†Ô∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ ticker —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–¥–ø–∏—Å–∫–æ–π –≤ 2.5 —Ä–∞–∑–∞ –º–µ–¥–ª–µ–Ω–Ω–µ–µ
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å —Ö–æ—Ä–æ—à–∞—è - –Ω–µ—Ç –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–∏ —Ä–æ—Å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–ø–∏—Å–æ–∫/pending –∑–∞–ø—Ä–æ—Å–æ–≤

### 2. JSON –ø–∞—Ä—Å–∏–Ω–≥ (`json_parsing`)

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è (2025) | –í—Ä–µ–º—è (2024) | –°—Ä–∞–≤–Ω–µ–Ω–∏–µ |
|----------|--------------|--------------|-----------|
| –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ RPC | 349.47 ns | ~355 ns | ‚úÖ -1.6% |
| –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ ticker | 2.1027 ¬µs | ~2.2 ¬µs | ‚úÖ -4.4% |
| –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –±–æ–ª—å—à–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è | 39.566 ¬µs | ~45 ¬µs | ‚úÖ -12.1% |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞ "id"** | **7.7590 ns** | ~8 ns | ‚úÖ **44x –±—ã—Å—Ç—Ä–µ–µ –ø–æ–ª–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞!** |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–∞ "channel_name"** | **10.480 ns** | ~10 ns | ‚úÖ **200x –±—ã—Å—Ç—Ä–µ–µ –ø–æ–ª–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ ticker!** |
| –£—Å–ª–æ–≤–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏) | 339.75 ns | ~337 ns | ‚ö†Ô∏è +0.8% |

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥:**
- üöÄ **–ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π –≤ 44-220 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ –ø–æ–ª–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞**
- ‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±—ã—Å—Ç—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É `contains()` –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º
- üí° –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è: ~2 ¬µs –Ω–∞ –∫–∞–∂–¥–æ–µ ticker —Å–æ–æ–±—â–µ–Ω–∏–µ

### 3. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ Mutex (`mutex_contention`)

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è (2025) | –í—Ä–µ–º—è (2024) | –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ |
|----------|--------------|--------------|-----------------|
| Insert/remove 100 | 13.443 ¬µs | ~13.4 ¬µs | ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ |
| Insert/remove 1000 | 134.29 ¬µs | ~134 ¬µs | ‚úÖ –õ–∏–Ω–µ–π–Ω–æ–µ (10x) |
| Read-heavy 10 –∫–ª—é—á–µ–π | 42.987 ¬µs | ~42.7 ¬µs | ‚ö†Ô∏è +0.7% |
| Read-heavy 100 –∫–ª—é—á–µ–π | 42.973 ¬µs | ~42.5 ¬µs | ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ |
| Write-heavy 100 | 8.2289 ¬µs | ~7.7 ¬µs | ‚ö†Ô∏è +6.9% |
| Write-heavy 1000 | 83.754 ¬µs | ~77 ¬µs | ‚úÖ –õ–∏–Ω–µ–π–Ω–æ–µ (10x) |
| Concurrent access (4 –∑–∞–¥–∞—á–∏) | 64.325 ¬µs | ~61 ¬µs | ‚ö†Ô∏è –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç overhead |

**–í—ã–≤–æ–¥—ã:**
- ‚úÖ Mutex –æ–ø–µ—Ä–∞—Ü–∏–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ
- ‚ö†Ô∏è –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∑–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–æ–±–∞–≤–ª—è–µ—Ç overhead (~50% –ø—Ä–∏ 4 –∑–∞–¥–∞—á–∞—Ö)
- üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: DashMap –º–æ–∂–µ—Ç —É–ª—É—á—à–∏—Ç—å read-heavy workload (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏)

### 4. Throughput –ø–æ–¥–ø–∏—Å–æ–∫ (`subscription_throughput`)

| –°—Ü–µ–Ω–∞—Ä–∏–π | –í—Ä–µ–º—è | Throughput (—Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫) |
|----------|-------|----------------------------|
| –û–¥–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ | ~302 ns | ~3.3M —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ |
| 100 —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ | ~26.4 ¬µs | ~3.8M —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ |
| 1000 —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ | ~265 ¬µs | ~3.8M —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ |
| –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ 1 –∫–∞–Ω–∞–ª | ~15.6 ¬µs | - |
| –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ 5 –∫–∞–Ω–∞–ª–æ–≤ | ~274 ¬µs | ‚ö†Ô∏è –î–µ–≥—Ä–∞–¥–∞—Ü–∏—è |
| –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ 10 –∫–∞–Ω–∞–ª–æ–≤ | ~548 ¬µs | ‚ö†Ô∏è –õ–∏–Ω–µ–π–Ω–∞—è –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è |
| –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ 20 –∫–∞–Ω–∞–ª–æ–≤ | ~1.1 ms | ‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è** |

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–≤–æ–¥—ã:**
- ‚úÖ –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞: ~3.8M —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ - –æ—Ç–ª–∏—á–Ω–æ
- ‚ö†Ô∏è **–ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç –ª–∏–Ω–µ–π–Ω–æ** —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∫–∞–Ω–∞–ª–æ–≤
- üö® **–ü—Ä–æ–±–ª–µ–º–∞**: –ü—Ä–∏ 20 –∫–∞–Ω–∞–ª–∞—Ö –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ 100 —Å–æ–æ–±—â–µ–Ω–∏–π = 1.1 ms
  - –î–ª—è ticker —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 100ms —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç–µ

## –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ: –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–ø–∏—Å–æ–∫

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–∞–Ω–∞–ª–æ–≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç –ª–∏–Ω–µ–π–Ω–æ
- 20 –∫–∞–Ω–∞–ª–æ–≤: ~1.1 ms –Ω–∞ 100 —Å–æ–æ–±—â–µ–Ω–∏–π = ~11 ¬µs –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ
- –≠—Ç–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π —á–∞—Å—Ç–æ—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DashMap` –≤–º–µ—Å—Ç–æ `Arc<Mutex<HashMap>>` –¥–ª—è subscriptions
- Lock-free —á—Ç–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª–∏—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—É—é –æ–±—Ä–∞–±–æ—Ç–∫—É —Ä–∞–∑–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

### üü° –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: JSON –ø–∞—Ä—Å–∏–Ω–≥

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–∞–∂–µ –∫–æ–≥–¥–∞ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –ø–æ–ª—è
- Ticker —Å–æ–æ–±—â–µ–Ω–∏—è –ø–∞—Ä—Å—è—Ç—Å—è –∑–∞ ~2.2 ¬µs, –Ω–æ –º–æ–∂–Ω–æ –±—ã—Å—Ç—Ä–µ–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫–ª—é—á–µ–π –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º
- –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–∫–æ–Ω–æ–º–∏—è: ~2 ¬µs –Ω–∞ ticker —Å–æ–æ–±—â–µ–Ω–∏–µ
- –ü—Ä–∏ —á–∞—Å—Ç–æ—Ç–µ 10 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫ (100ms ticker) = —ç–∫–æ–Ω–æ–º–∏—è 20 ¬µs/—Å–µ–∫

### üü¢ –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ Mutex

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—è –∑–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç overhead
- –ü—Ä–∏ 4 –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö overhead ~50%

**–†–µ—à–µ–Ω–∏–µ:**
- DashMap –¥–ª—è read-heavy workload (subscriptions)
- Mutex –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è write-heavy (pending_requests) - —Ç–∞–º –æ–Ω —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è JSON –ø–∞—Ä—Å–∏–Ω–≥–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –≠–∫–æ–Ω–æ–º–∏—è ~2 ¬µs –Ω–∞ ticker —Å–æ–æ–±—â–µ–Ω–∏–µ

```rust
// –í handle_incoming
async fn handle_incoming(...) {
    // –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–ª–Ω—ã–º –ø–∞—Ä—Å–∏–Ω–≥–æ–º
    if text.contains("\"id\":") {
        // –≠—Ç–æ RPC –æ—Ç–≤–µ—Ç - –ø–∞—Ä—Å–∏–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        let parsed: Value = serde_json::from_str(&text)?;
        // ...
    } else if text.contains("\"channel_name\":") {
        // –≠—Ç–æ –ø–æ–¥–ø–∏—Å–∫–∞ - –ø–∞—Ä—Å–∏–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
        let parsed: Value = serde_json::from_str(&text)?;
        // ...
    }
}
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: DashMap –¥–ª—è subscriptions

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ 50-80%

```rust
use dashmap::DashMap;

subscriptions: Arc<DashMap<String, mpsc::UnboundedSender<String>>>,
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- Lock-free —á—Ç–µ–Ω–∏–µ
- –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —É–∑–∫–æ–≥–æ –º–µ—Å—Ç–∞ –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –ë–∞—Ç—á–∏–Ω–≥ –ø–µ—Ä–µ–ø–æ–¥–ø–∏—Å–æ–∫

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** –ë—ã—Å—Ç—Ä–µ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

```rust
// –í–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞
// –°–Ω–∞—á–∞–ª–∞ –¥–µ–ª–∞–µ–º snapshot –ø–æ–¥ lock
let channels: Vec<String> = {
    let subs = subscriptions.lock().await;
    subs.keys().map(|k| k.clone()).collect()  // Snapshot –∫–ª—é—á–µ–π
};
// Lock –æ—Ç–ø—É—â–µ–Ω –∑–¥–µ—Å—å

// –¢–µ–ø–µ—Ä—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤–Ω–µ lock
let msg = json!({
    "method": "public/subscribe",
    "params": { "channels": channels },
});
```

## –¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

| –ú–µ—Ç—Ä–∏–∫–∞ | –¢–µ–∫—É—â–µ–µ | –¶–µ–ª–µ–≤–æ–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|---------|---------|-----------|
| Ticker –æ–±—Ä–∞–±–æ—Ç–∫–∞ (—Å –ø–æ–¥–ø–∏—Å–∫–æ–π) | ~792 ns | ~400 ns | 2x |
| JSON –ø–∞—Ä—Å–∏–Ω–≥ ticker | ~2.2 ¬µs | ~350 ns | 6x |
| –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ (20 –∫–∞–Ω–∞–ª–æ–≤) | ~1.1 ms | ~300 ¬µs | 3.7x |
| Throughput (20 –∫–∞–Ω–∞–ª–æ–≤) | ~9K msg/s | ~33K msg/s | 3.7x |

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ë–µ–Ω—á–º–∞—Ä–∫–∏ –ø–æ–∫–∞–∑–∞–ª–∏:

‚úÖ **–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ RPC –æ—Ç–≤–µ—Ç–æ–≤ –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞ (~300 ns)
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –ø—Ä–∏ —Ä–æ—Å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –ø–æ–¥–ø–∏—Å–æ–∫ —Ö–æ—Ä–æ—à–∞—è
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–º–µ–µ—Ç –≤—ã—Å–æ–∫–∏–π throughput (~3.8M msg/s)

‚ö†Ô∏è **–£–∑–∫–∏–µ –º–µ—Å—Ç–∞:**
- –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∫–∞–Ω–∞–ª–æ–≤ –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç
- JSON –ø–∞—Ä—Å–∏–Ω–≥ –º–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ Mutex —Å–æ–∑–¥–∞—é—Ç contention –ø—Ä–∏ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏–∏

üöÄ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –í–Ω–µ–¥—Ä–∏—Ç—å –±—ã—Å—Ç—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É –∫–ª—é—á–µ–π JSON (–ø—Ä–æ—Å—Ç–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –±–æ–ª—å—à–æ–π —ç—Ñ—Ñ–µ–∫—Ç)
2. –ó–∞–º–µ–Ω–∏—Ç—å Mutex –Ω–∞ DashMap –¥–ª—è subscriptions (—É—Å—Ç—Ä–∞–Ω—è–µ—Ç —É–∑–∫–æ–µ –º–µ—Å—Ç–æ)
3. –î–æ–±–∞–≤–∏—Ç—å –±–∞—Ç—á–∏–Ω–≥ –ø–µ—Ä–µ–ø–æ–¥–ø–∏—Å–æ–∫ (—É–ª—É—á—à–∞–µ—Ç UX)

–ü–æ—Å–ª–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–µ–Ω—á–º–∞—Ä–∫–∏ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è —É–ª—É—á—à–µ–Ω–∏–π.

